## 병행 프로세스

- 병행 프로세스 간에 **비동기적(Asynchronous)** 이라는 것은 다른 프로세스들이 어떤 상태에 있고, 어떤 자원을 가지고있고, 어디까지 실행됐는지 모른채 실행되고 있음을 뜻함
- 병행 프로세스들의 비동기적 실행은 공유된 자원이 없는한 문제없이 독립적으로 진행되지만, 공유된 자원이 있을 경우 이 자원의 접근에는 룰(rule)을 따라야함
- 여기서 룰이란 한번에 한 프로세스만이 접근하도록 하고, 해당 자원에 대해 의도했던 실행을 완료하도록 보장하는 것

<br>

## 상호배제(Mutual Exclusion)

- 경쟁 상태(Race Conditon) : 프로세스들이 공유 데이터에 대해 서로 접근을 시도하는 상황
- 경쟁 관계에 있는 프로세스들로 인해 **상호배제**, 교착상태(Deadlock), 기아(Starvation)와 같은 문제가 발생함
- **상호배제** : 한번에 하나의 프로세스만 임계영역에 들어가야 함 (뮤텍스, Mutex 라고도 함)
- **임계영역(Critical Section)** : 두개 이상의 프로세스가 동시에 사용할 수 없는 자원(임계자원)에 접근하고 실행하는 프로그램 내의 코드 부분
- 임계영역에 들어갈 프로세스는 먼저 다른 프로세스가 임계영역에 있는지 확인하고 나올때는 알려야 한다.
- 운영체제는 사용자의 상호배제 구현을 지원하기 위한 구조로 모니터(Monitor)같은 프로그래밍 언어 수준의 도구를 제공함

<br>

### 임계구역 문제를 해결하기 위한 3가지 조건

임계구역에서 발생하는 문제들은 3가지 조건을 충족시키면 해결할 수 있다.

1. Mutual Exclusion(상호배제) : 하나의 프로세스가 임계구역에 들어가 있으면 다른 프로세스는 들어갈 수 없다.
2. Progress(진행) : 임계구역에 들어간 프로세스가 없다면, 어느 프로세스가 들어갈 것인지 적절히 선택해줘야 한다.
3. Bounded Waiting(한정 대기) : 기아상태를 방지하기 위해, 한 번 들어갔다 나온 프로세스는 다음에 들어갈 때 제한을 준다.

<br>

## 세마포어(Semaphore)

- 특수한 명령들만 접근할 수 있게 허용되는 보호된 변수
- 공유된 자원의 데이터를 여러 프로세스가 접근하는 것을 막는 것
- 상호배제 명령을 구현할 수 있게 함
- 이진 세마포어 : 세마포어가 0아니면 1의 이진값만 가짐
- 계수(Counting) or 정수(Integer) 세마포어 : 세마포어 값이 음이 아닌 모든 정수

### 바쁜 대기(busy waiting)

A와 B라는 두개의 쓰레드가 공유 자원을 사용하려고 할때 a쓰레드가 공유 자원을 먼저 사용하게 되면 b쓰레드는 a쓰레드가 사용을 마칠때 까지 기다려야 한다. 이때 b쓰레드는 a쓰레드가 공유 자원 사용을 끝냈는지 계속 무한 루프를 돌면서 확인하게 되는데 이것이 **바쁜 대기**이다. 바쁜대기는 모니터나 세마포어를 사용해서 피할 수 있다.

<br>

## 뮤텍스와 세마포어의 차이

- 가장 큰 차이점은 뮤텍스는 동기화 대상이 오직 하나뿐일 때, 세마포어는 동기화 대상이 하나 이상일 때 사용한다.
- 세마포어는 자원의 상태를 나타내는 일종의 변수로써 소유 개념이 아니지만, 뮤텍스는 자원을 점유한 프로세스나 쓰레드가 잠시 소유하였다가 작업이 끝나면 반환하는 개념이다.
- 세마포어는 소유할 수 없는 반면, 뮤텍스는 소유가 가능하며 소유주가 이에 대한 책임을 가진다.
- 뮤텍스의 경우 뮤텍스를 소유하고 있는 스레드가 이 뮤텍스를 해제할 수 있다. 하지만 세마포어의 경우 이러한 세마포어를 소유하지 않는 스레드가 세마포어를 해제할 수 있다.
